<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Aquarium AR</title>

<script type="module"
  src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js">
</script>

<style>
body {
  margin: 0;
  overflow: hidden;
  font-family: Arial;
  background: #003049;
}

/* Fond aquarium */
#aquarium-bg {
  position: fixed;
  inset: 0;
  background: linear-gradient(#005f73, #001219);
  z-index: 0;
}

/* Zone AR */
#aquarium {
  position: relative;
  width: 100%;
  height: 100vh;
  z-index: 1;
}

/* Poissons */
.fish {
  position: absolute;
  width: 200px;
  height: 200px;
  pointer-events: none;
}
</style>
</head>

<body>

<div id="aquarium-bg"></div>

<div id="aquarium">

  <!-- POISSON 1 -->
  <model-viewer
    class="fish"
    id="fish1"
    src="fish.glb"
    ar
    ar-modes="quick-look webxr"
    camera-controls
    shadow-intensity="1">
  </model-viewer>

  <!-- POISSON 2 -->
  <model-viewer
    class="fish"
    id="fish2"
    src="fish3.glb"
    camera-controls
    shadow-intensity="1">
  </model-viewer>


   <!-- POISSON 3 -->
  <model-viewer
    class="fish"
    id="fish3"
    src="fish3.glb"
    camera-controls
    shadow-intensity="1">
  </model-viewer>

</div>

<script>
// -------- PARAMÈTRES GÉNÉRAUX ----------
const fishes = [
  { el: document.getElementById('fish1'), speed: 0.35, x: 200, dir: 1, wave: 0 },
  { el: document.getElementById('fish2'), speed: 0.25, x: 600, dir: -1, wave: 2 },
  { el: document.getElementById('fish3'), speed: 0.5, x: 1000, dir: 1, wave: 3 }
];

function bounds() {
  return {
    left: window.innerWidth * 0.1,
    right: window.innerWidth * 0.9
  };
}

// -------- ANIMATION ----------
function animate() {
  const b = bounds();

  fishes.forEach(f => {
    // ralentissement à l’approche des bords
    let slowFactor = 1;
    if (f.x > b.right - 100 || f.x < b.left + 100) {
      slowFactor = 0.4;
    }

    f.x += f.speed * f.dir * slowFactor;

    // rebond
    if (f.x >= b.right) f.dir = -1;
    if (f.x <= b.left) f.dir = 1;

    // ondulation
    f.wave += 0.05;
    const y = Math.sin(f.wave) * 12;
    const rot = Math.sin(f.wave) * 6;

    f.el.style.transform = `
      translate(${f.x}px, ${y}px)
      scaleX(${f.dir})
      rotate(${rot}deg)
    `;
  });

  requestAnimationFrame(animate);
}

animate();
</script>

</body>
</html>
